<!DOCTYPE html>
<html lang="id">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Permainan Kartu Memori</title>

    <style>
        /* Reset Dasar */
        *,
        *::before,
        *::after {
            box-sizing: border-box;
            margin: 0;
            padding: 0;
        }

        /* Tampilan Body Utama */
        body {
            font-family: -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto,
                Helvetica, Arial, sans-serif;
            display: flex;
            justify-content: center;
            align-items: center;
            min-height: 100vh;
            background-color: #f0f4f8;
            color: #333;
        }

        /* Kontainer Game */
        main {
            display: flex;
            flex-direction: column;
            align-items: center;
            padding: 20px;
            max-width: 500px; /* Lebar maksimum untuk papan permainan */
            width: 100%;
        }

        h1 {
            color: #2c3e50;
            margin-bottom: 1.5rem;
            text-align: center;
        }

        /* Kontrol Game (Mode & Reset) */
        .game-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
            margin-bottom: 1.5rem;
            gap: 15px;
        }

        .game-controls select,
        .game-controls button {
            font-size: 1rem;
            padding: 0.6rem 1rem;
            border-radius: 8px;
            border: 1px solid #bdc3c7;
            cursor: pointer;
            flex-grow: 1; /* Agar tombol dan select mengisi ruang */
        }

        .game-controls button {
            background-color: #e74c3c;
            color: white;
            border-color: #e74c3c;
            font-weight: 600;
        }

        .game-controls button:hover {
            background-color: #c0392b;
        }

        /* Info Status Game (Skor/Giliran) */
        .game-info {
            display: flex;
            justify-content: space-around;
            width: 100%;
            margin-bottom: 1.5rem;
            font-size: 1.2rem;
            font-weight: bold;
        }
        
        #player1Info, #player2Info {
            padding: 10px 15px;
            border-radius: 8px;
            transition: all 0.3s ease;
            border: 2px solid transparent;
        }
        
        /* Menandakan giliran pemain */
        .game-info .active {
            color: #3498db;
            border-color: #3498db;
            background-color: #ecf5fd;
        }

        /* Papan Permainan (CSS Grid) */
        .game-board {
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            gap: 12px;
            width: 100%;
            max-width: 450px;
            /* Membuat papan responsif persegi */
            aspect-ratio: 1 / 1; 
            /* Diperlukan untuk efek flip 3D */
            perspective: 1000px;
        }

        /* Kartu */
        .card {
            width: 100%;
            height: 100%;
            position: relative;
            cursor: pointer;
            /* Efek transisi untuk flip */
            transform-style: preserve-3d;
            transition: transform 0.6s;
        }

        /* Sisi Depan dan Belakang Kartu */
        .card-face {
            position: absolute;
            width: 100%;
            height: 100%;
            display: flex;
            justify-content: center;
            align-items: center;
            border-radius: 8px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.05);
            /* Menyembunyikan sisi belakang saat membalik */
            backface-visibility: hidden; 
        }

        /* Sisi Belakang (Tertutup) */
        .card-back {
            background-color: #3498db;
            color: white;
            font-size: 2.5rem;
            font-weight: bold;
        }

        /* Sisi Depan (Terbuka - berisi simbol) */
        .card-front {
            background-color: #ecf0f1;
            font-size: 2.5rem; /* Ukuran emoji */
            /* Diputar 180 derajat secara default */
            transform: rotateY(180deg); 
        }

        /* Status Kartu */
        .card.is-flipped {
            transform: rotateY(180deg);
        }

        .card.is-matched {
            /* Sedikit pudar untuk menandakan sudah cocok */
            opacity: 0.6; 
            cursor: default;
        }

        /* Overlay Kemenangan */
        .victory-overlay {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: rgba(0, 0, 0, 0.75);
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        .victory-message {
            background-color: white;
            padding: 2.5rem 3rem;
            border-radius: 12px;
            text-align: center;
            box-shadow: 0 10px 30px rgba(0, 0, 0, 0.1);
        }

        .victory-message h2 {
            margin-bottom: 1.5rem;
            color: #2c3e50;
        }

        /* Tombol di overlay kemenangan */
        #playAgainButton {
            font-size: 1.1rem;
            padding: 0.8rem 1.5rem;
            border: none;
            border-radius: 8px;
            background-color: #2ecc71;
            color: white;
            font-weight: 600;
            cursor: pointer;
        }
        
        #playAgainButton:hover {
            background-color: #27ae60;
        }

        /* Kelas utilitas */
        .hidden {
            display: none;
        }
        
        /* Responsif untuk layar kecil */
        @media (max-width: 480px) {
            .card-front, .card-back {
                font-size: 2rem;
            }
            .game-info {
                font-size: 1rem;
            }
        }
    </style>
</head>
<body>

    <main>
        <h1>Permainan Kartu Memori</h1>

        <div class="game-controls">
            <select id="gameMode">
                <option value="1">1 Pemain</option>
                <option value="2">2 Pemain</option>
            </select>
            <button id="resetButton">Reset Game</button>
        </div>

        <div class="game-info">
            <div id="player1Info">Gerakan: 0</div>
            <div id="player2Info" class="hidden">Pemain 2: 0</div>
        </div>

        <div class="game-board" id="gameBoard">
            </div>
    </main>

    <div id="victoryOverlay" class="victory-overlay hidden">
        <div class="victory-message">
            <h2 id="victoryText">Kamu Menang!</h2>
            <button id="playAgainButton">Main Lagi</button>
        </div>
    </div>

    <script>
        document.addEventListener('DOMContentLoaded', () => {

            // === 1. Seleksi Elemen DOM ===
            const gameBoard = document.getElementById('gameBoard');
            const resetButton = document.getElementById('resetButton');
            const playAgainButton = document.getElementById('playAgainButton');
            const gameModeSelect = document.getElementById('gameMode');
            const player1Info = document.getElementById('player1Info');
            const player2Info = document.getElementById('player2Info');
            const victoryOverlay = document.getElementById('victoryOverlay');
            const victoryText = document.getElementById('victoryText');

            // === 2. Variabel Game ===
            const symbols = ['üçé', 'üçå', 'üçí', 'üçì', 'üçá', 'üçâ', 'üçç', 'üçë'];
            let cardsArray = [];
            let flippedCards = [];
            let lockBoard = false;
            let matchedPairs = 0;

            // Variabel Status Pemain
            let mode = '1'; // Default 1 Pemain
            let moves = 0;
            let player1Score = 0;
            let player2Score = 0;
            let currentPlayer = 1;

            // === 3. Fungsi Utama Game ===

            /**
             * Memulai atau me-reset permainan.
             */
            function initGame() {
                // Reset variabel status
                mode = gameModeSelect.value;
                moves = 0;
                player1Score = 0;
                player2Score = 0;
                currentPlayer = 1;
                matchedPairs = 0;
                flippedCards = [];
                lockBoard = false;

                // Perbarui tampilan info
                updateInfoDisplay();
                // Sembunyikan pesan kemenangan
                victoryOverlay.classList.add('hidden');

                // Buat papan permainan
                createBoard();
            }

            /**
             * Membuat dan mengisi papan permainan.
             */
            function createBoard() {
                gameBoard.innerHTML = '';
                cardsArray = [...symbols, ...symbols]; // Duplikasi simbol
                shuffle(cardsArray); // Acak simbol

                // Buat 16 elemen kartu
                cardsArray.forEach(symbol => {
                    const card = document.createElement('div');
                    card.classList.add('card');
                    card.dataset.symbol = symbol; // Simpan simbol di data attribute

                    card.innerHTML = `
                        <div class="card-face card-front">${symbol}</div>
                        <div class="card-face card-back">?</div>
                    `;

                    card.addEventListener('click', handleCardClick);
                    gameBoard.appendChild(card);
                });
            }

            /**
             * Mengacak array (Algoritma Fisher-Yates).
             */
            function shuffle(array) {
                for (let i = array.length - 1; i > 0; i--) {
                    const j = Math.floor(Math.random() * (i + 1));
                    [array[i], array[j]] = [array[j], array[i]];
                }
            }

            /**
             * Menangani logika saat kartu diklik.
             */
            function handleCardClick(event) {
                if (lockBoard) return; // Keluar jika papan terkunci
                
                const clickedCard = event.currentTarget;

                // Mencegah klik pada kartu yang sama atau sudah cocok
                if (clickedCard === flippedCards[0] || clickedCard.classList.contains('is-matched')) {
                    return;
                }

                // Balik kartu
                flipCard(clickedCard);
                flippedCards.push(clickedCard);

                // Cek jika sudah 2 kartu dibalik
                if (flippedCards.length === 2) {
                    // Satu gerakan selesai (untuk mode 1P)
                    if (mode === '1') {
                        moves++;
                    }
                    lockBoard = true; // Kunci papan
                    checkForMatch();
                    updateInfoDisplay(); // Update gerakan
                }
            }
            
            /**
             * Membalik kartu (menambah/menghapus kelas CSS).
             */
            function flipCard(card) {
                card.classList.add('is-flipped');
            }

            /**
             * Memeriksa apakah kedua kartu yang dibalik cocok.
             */
            function checkForMatch() {
                const [card1, card2] = flippedCards;
                const isMatch = card1.dataset.symbol === card2.dataset.symbol;

                isMatch ? handleMatch(card1, card2) : handleMismatch(card1, card2);
            }

            /**
             * Logika jika kartu cocok.
             */
            function handleMatch(card1, card2) {
                card1.classList.add('is-matched');
                card2.classList.add('is-matched');

                matchedPairs++;

                // Logika skor untuk 2 Pemain
                if (mode === '2') {
                    if (currentPlayer === 1) {
                        player1Score++;
                    } else {
                        player2Score++;
                    }
                    // Pemain yang berhasil mencocokkan dapat giliran lagi
                }
                
                updateInfoDisplay();
                resetTurn();
                checkGameOver();
            }

            /**
             * Logika jika kartu tidak cocok.
             */
            function handleMismatch(card1, card2) {
                // Beri jeda 1 detik sebelum membalik kembali
                setTimeout(() => {
                    card1.classList.remove('is-flipped');
                    card2.classList.remove('is-flipped');

                    // Ganti giliran hanya jika tidak cocok (mode 2P)
                    if (mode === '2') {
                        switchPlayer();
                    }
                    
                    updateInfoDisplay();
                    resetTurn();
                }, 1000);
            }
            
            /**
             * Ganti giliran pemain.
             */
            function switchPlayer() {
                currentPlayer = currentPlayer === 1 ? 2 : 1;
            }

            /**
             * Mereset status giliran (kartu terbalik & kunci papan).
             */
            function resetTurn() {
                flippedCards = [];
                lockBoard = false;
            }

            /**
             * Memperbarui tampilan info (skor/gerakan/giliran).
             */
            function updateInfoDisplay() {
                if (mode === '1') {
                    // Mode 1 Pemain
                    player1Info.textContent = `Gerakan: ${moves}`;
                    player2Info.classList.add('hidden');
                    player1Info.classList.remove('active');
                } else {
                    // Mode 2 Pemain
                    player1Info.textContent = `Pemain 1: ${player1Score}`;
                    player2Info.textContent = `Pemain 2: ${player2Score}`;
                    player2Info.classList.remove('hidden');

                    // Tampilkan giliran aktif
                    if (currentPlayer === 1) {
                        player1Info.classList.add('active');
                        player2Info.classList.remove('active');
                    } else {
                        player1Info.classList.remove('active');
                        player2Info.classList.add('active');
                    }
                }
            }

            /**
             * Memeriksa apakah permainan sudah selesai.
             */
            function checkGameOver() {
                if (matchedPairs === symbols.length) {
                    lockBoard = true; // Kunci total papan
                    setTimeout(showVictoryMessage, 500); // Tunda sedikit
                }
            }

            /**
             * Menampilkan pesan kemenangan.
             */
            function showVictoryMessage() {
                if (mode === '1') {
                    victoryText.textContent = `Selesai! Kamu butuh ${moves} gerakan.`;
                } else {
                    if (player1Score > player2Score) {
                        victoryText.textContent = `Pemain 1 Menang! üéâ`;
                    } else if (player2Score > player1Score) {
                        victoryText.textContent = `Pemain 2 Menang! ü•≥`;
                    } else {
                        victoryText.textContent = `Permainan Seri! ü§ù`;
                    }
                }
                victoryOverlay.classList.remove('hidden');
            }

            // === 4. Event Listeners ===
            resetButton.addEventListener('click', initGame);
            playAgainButton.addEventListener('click', initGame);
            gameModeSelect.addEventListener('change', initGame); // Reset jika mode ganti

            // === 5. Mulai Game Saat Halaman Dimuat ===
            initGame();

        });
    </script>

</body>
</html>
